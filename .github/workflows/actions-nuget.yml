name: Add package source using actions/setup-dotnet@v1.4.0

on: [push]

jobs:
  build:

    runs-on: ubuntu-latest

    steps:
    - name: Setup .NET Core
      uses: actions/setup-dotnet@v1.4.0
      with:
        dotnet-version: 3.1.100
        source-url: https://nuget.pkg.github.com/jcansdale/index.json
      env:
        NUGET_AUTH_TOKEN: ${{secrets.GITHUB_TOKEN}}

    - name: Create a .NET Core application
      run: dotnet new console

    - name: Add a public package from GitHub Packages
      run: dotnet add package NetCoreConsole --version 1.0.6

    - name: Clear the NuGet cache
      run: dotnet nuget locals all --clear

    - name: Restore packages
      run: dotnet restore MonoNuGetExample.csproj

    - name: Build and run the application
      run: dotnet run
